"0","predictions <- rforest[[""pred""]]"
"0",""
"0","# Initialize an empty matrix to store results"
"0","xv_results <- matrix(NA, nrow = 10, ncol = 7,"
"0","                  dimnames = list(NULL, c(""Fold"", ""AUC"", ""ACC"", ""PRE"", ""FPR"", ""TNR"", ""TPR"")))"
"0",""
"0","# Loop through each fold"
"0","for (i in 1:10) {"
"0"," # Subset the predictions dataframe for the current fold"
"0"," fold <- subset(predictions, Resample == paste0(""Resample"", sprintf(""%02d"", i)))"
"0"," "
"0"," # Create confusion matrix"
"0"," conf_matrix <- confusionMatrix(data = factor(fold$pred), reference = factor(fold$obs), positive = ""Yes"")"
"0"," "
"0"," # Extract the confusion matrix"
"0"," cm <- conf_matrix$table"
"0"," "
"0"," # Calculate True Positives (TP), True Negatives (TN), False Positives (FP)"
"0"," TN <- cm[""No"",  ""No""]"
"0"," FN <- cm[""No"",  ""Yes""]"
"0"," FP <- cm[""Yes"", ""No""]"
"0"," TP <- cm[""Yes"", ""Yes""]"
"0"," "
"0"," # Calculate Accuracy"
"0"," ACC <- (TP + TN) / sum(cm)"
"0"," "
"0"," # Calculate Precision"
"0"," PRE <- TP / (TP + FP)"
"0"," "
"0"," # Calculate False Positive Rate (FPR)"
"0"," FPR <- FP / (FP + TN)"
"0"," "
"0"," # Calculate True Negative Rate (TNR)"
"0"," TNR <- TN / (TN + FP)"
"0"," "
"0"," # Calculate True Positive Rate (TPR)"
"0"," TPR <- TP / (TP + FN)"
"0"," "
"0"," # Calculate AUC using cutpointr"
"0"," cut.obj <- cutpointr(x = fold$Yes, class = fold$obs)"
"0"," AUC <- auc(cut.obj)"
"0"," "
"0"," # Store results in the matrix"
"0"," xv_results[i, ] <- c(i, AUC, ACC, PRE, FPR, TNR, TPR)"
"0","}"
"0",""
"0","# Print the results matrix"
"0","xv_results <- as.data.frame(xv_results)"
"0",""
"0","# Calculate mean and standard deviation and round to the second decimal point"
"0","mean_values <- sapply(xv_results[, -1], function(x) round(mean(x), 2))"
"0","sd_values <- sapply(xv_results[, -1], function(x) round(sd(x), 2))"
"0",""
"0","# Print means and standard deviations"
"0","cat(""Mean:\n"")"
"1","Mean:
"
"0","print(mean_values)"
"1"," AUC "
"1"," ACC "
"1"," PRE "
"1"," FPR "
"1"," TNR "
"1"," TPR "
"1","
"
"1","0.77 "
"1","0.74 "
"1","0.75 "
"1","0.36 "
"1","0.64 "
"1","0.82 "
"1","
"
"0","cat(""\nStandard Deviation:\n"")"
"1","
Standard Deviation:
"
"0","print(sd_values)"
"1"," AUC "
"1"," ACC "
"1"," PRE "
"1"," FPR "
"1"," TNR "
"1"," TPR "
"1","
"
"1","0.05 "
"1","0.05 "
"1","0.07 "
"1","0.08 "
"1","0.08 "
"1","0.06 "
"1","
"
