"0","ds1$demoage <- factor(ds1$demoage, levels = c(1, 2, 3), "
"0","                      labels = c(""Age 14 to 17"", ""Age 18 to 20"", ""Age 21 to 24""))"
"0",""
"0","ds1$demorac <- factor(ds1$demorac, levels = c(4, 5, 6, 7),"
"0","                      labels = c(""AA or Black"", ""White"", ""Multiple Races"", "
"0","                                 ""American Indian/Asian/Native Hawaiian""))"
"0",""
"0","ds1$demosex <- factor(ds1$demosex, levels = c(1, 2),"
"0","                      labels = c(""Male"", ""Female""))"
"0",""
"0","ds1$livewith <- factor(ds1$livewith, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$school <- factor(ds1$school, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$gang1 <- factor(ds1$gang1, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1 <- mutate(ds1, weapon1 = ifelse(weapon1 > 0, 1, 0))"
"0",""
"0","ds1 <- mutate(ds1, weapon2a = ifelse(weapon2a > 0, 1, 0))"
"0",""
"0","ds1$weapon1 <- factor(ds1$weapon1, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$weapon2a <- factor(ds1$weapon2a, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$earlyinit_mj <- with(ds1, ifelse(agepot >= 1 & agepot <= 7, ""Yes"","
"0","                        ifelse(agepot == 0 | agepot >= 8, ""No"", NA)))"
"0",""
"0","ds1$earlyinit_mj <- factor(ds1$earlyinit_mj, levels = c(""No"", ""Yes""))"
"0",""
"0","ds1$earlyinit_alc <- with(ds1, ifelse(agedrk >= 1 & agedrk <= 7, ""Yes"","
"0","                        ifelse(agedrk == 0 | agedrk >= 8, ""No"", NA)))"
"0",""
"0","ds1$earlyinit_alc <- factor(ds1$earlyinit_alc, levels = c(""No"", ""Yes""))"
"0",""
"0","# Create a function to recode the variables"
"0","recode_age <- function(x) {"
"0","  ifelse(x >= 1 & x <= 7, ""Yes"","
"0","         ifelse(x == 0 | x >= 8, ""No"", NA))"
"0","}"
"0",""
"0","# Apply the recoding function to each variable and store the result in a new column"
"0","ds1$earlyinit_oth <- with(ds1, "
"0","  ifelse(recode_age(agecoc) == ""Yes"" |"
"0","         recode_age(agemeth) == ""Yes"" |"
"0","         recode_age(ageinhal) == ""Yes"" |"
"0","         recode_age(agehal) == ""Yes"" |"
"0","         recode_age(ageop) == ""Yes"" |"
"0","         recode_age(ageprstim) == ""Yes"" |"
"0","         recode_age(ageprsed) == ""Yes"" |"
"0","         recode_age(ageprop) == ""Yes"", ""Yes"", ""No""))"
"0",""
"0","# Columns to include in the calculation"
"0","age_columns <- c(""agepot"", ""agecoc"", ""agemeth"", ""ageinhal"", ""agehal"", ""ageop"", ""ageprstim"", "
"0","                 ""ageprsed"", ""ageprop"", ""agedrk"")"
"0",""
"0","# Function to find the minimum value greater than zero or return NA if only zeros or NAs"
"0","min_nonzero <- function(row) {"
"0","  non_zero_values <- row[row > 0 & !is.na(row)]"
"0","  if (length(non_zero_values) == 0) {"
"0","    return(NA)"
"0","  } else {"
"0","    return(min(non_zero_values, na.rm = TRUE))"
"0","  }"
"0","}"
"0",""
"0","# Apply the function to the relevant columns"
"0","ds1$agedruginit <- apply(ds1[age_columns], 1, min_nonzero)"
"0",""
"0","ds1$agedruginit <- ds1$agedruginit + 7 #to make years rather than Likert"
"0",""
"0","ds1$sexint <- factor(ds1$sex, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$binge <- factor(ds1$binge, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$publicass <- factor(ds1$publicass, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$partnervic <- factor(ds1$partnervic, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds1$pcts <- factor(ds1$pcts, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds2$vgroup <- factor(ds2$vgroup, levels = c(0, 1), "
"0","                     labels = c(""Comparison Group"", ""Assaulted Group""))"
"0",""
"0","ds2$alcdx <- factor(ds2$alcdx, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds2$drugdx <- factor(ds2$drugdx, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds2$ptsd <- factor(ds2$ptsd, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds2$cdapd <- factor(ds2$conductdisorder, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds2$legalsev <- ds2$asiteen11"
"0",""
"0","ds2 <- mutate(ds2, personalcrime = ifelse(asiteen2_c1g1 > 0, 1, 0))"
"0",""
"0","ds2 <- mutate(ds2, propertycrime = ifelse(asiteen2_c1g2 > 0, 1, 0))"
"0",""
"0","ds2 <- mutate(ds2, drugcrime = ifelse(asiteen2_c1g3 > 0, 1, 0))"
"0",""
"0","ds2 <- mutate(ds2, publicorder = ifelse(asiteen2_c1g4 > 0, 1, 0))"
"0",""
"0","ds2 <- mutate(ds2, parprobcc = ifelse(asiteen2_c1g5 > 0, 1, 0))"
"0",""
"0","ds2$sexdrug <- factor(ds2$sexdrug, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds2$mentman <- factor(ds2$mentman, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds2$mentwoman <- factor(ds2$mentwoman, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3$vgroup <- factor(ds3$vgroup, levels = c(0, 1), "
"0","                     labels = c(""Comparison Group"", ""Assaulted Group""))"
"0",""
"0","ds3$alcdx <- factor(ds3$alcdx, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3$drugdx <- factor(ds3$drugdx, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3$ptsd <- factor(ds3$ptsd, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3$cdapd <- factor(ds3$apd, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3$legalsev <- ds3$asi12"
"0",""
"0","ds3$sexdrug <- factor(ds3$sexdrug, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3$mentman <- factor(ds3$mentman, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3$mentwoman <- factor(ds3$mentwoman, levels = c(0, 1), labels = c(""No"", ""Yes""))"
"0",""
"0","ds3 <- mutate(ds3, personalcrime = ifelse(asi2_c1g1 > 0, 1, 0))"
"0",""
"0","ds3 <- mutate(ds3, propertycrime = ifelse(asi2_c1g2 > 0, 1, 0))"
"0",""
"0","ds3 <- mutate(ds3, drugcrime = ifelse(asi2_c1g3 > 0, 1, 0))"
"0",""
"0","ds3 <- mutate(ds3, publicorder = ifelse(asi2_c1g4 > 0, 1, 0))"
"0",""
"0","ds3 <- mutate(ds3, parprobcc = ifelse(asi2_c1g5 > 0, 1, 0))"
